<!DOCTYPE html>
<!-- saved from url=(0052)http://fiddle.jshell.net/rniemeyer/dLCL8/show/light/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>knockout viewmodel property undefined</title>
  
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <script type="text/javascript" src="./mootools-core-1.4.3-compat.js"></script>
    <link rel="stylesheet" type="text/css" href="./normalize.css">

    <link rel="stylesheet" type="text/css" href="./result-light.css">

      <script type="text/javascript" src="./knockout-2.2.1.js"></script>

  <style id="compiled-css" type="text/css">
      .selected { background: #ccc; }
    /* EOS */
  </style>

  <script id="insert"></script>


</head>
<body>
    <div id="customersArea" data-bind="foreach: people">
    <div class="section" data-bind="attr: { &#39;personid&#39;: PersonId }" personid="33">
        <div class="sectionText">
            <span data-bind="text: PersonId">33</span>
            <span data-bind="textWithInit: &#39;LastName&#39;">frank</span>
            <span data-bind="textWithInit: &#39;FirstName&#39;"></span>
            <span data-bind="if:$data.MailingAddress"></span>

            <span data-bind="textWithInit: &#39;EmailAddress&#39;"></span>
            <span data-bind="textWithInit: &#39;MainPhoneNumber&#39;"></span>
            <span data-bind="textWithInit: &#39;MobilePhoneNumber&#39;"></span>
        </div>
    </div>
</div>
<hr>



    <script type="text/javascript">//<![CDATA[


//rewrite binding after making sure that it is initialized
ko.bindingHandlers.textWithInit = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = valueAccessor();

        if (!ko.isObservable(viewModel[value])) {
            viewModel[value] = ko.observable(viewModel[value]);   
        }
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        ko.bindingHandlers.text.update(element, function() { return viewModel[valueAccessor()]; });
    }
};

var viewModel = {
    people: ko.observableArray([
    { PersonId: 33, LastName: 'frank' }        
    ])        
};    
   

ko.applyBindings(viewModel);


  //]]></script>

  <script>
    // tell the embed parent frame the height of the content
    if (window.parent && window.parent.parent){
      window.parent.parent.postMessage(["resultsFrame", {
        height: document.body.getBoundingClientRect().height,
        slug: "dLCL8"
      }], "*")
    }

    // always overwrite window.name, in case users try to set it manually
    window.name = "result"
  </script>




</body></html>